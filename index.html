<!DOCTYPE html>
<html lang="ky">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аркан Тартыш Онлайн</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --p1-color: #3498db; --p2-color: #e74c3c; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: white; overflow: hidden; touch-action: manipulation; }
        
        #lobby { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #16213e; }
        .selector { display: flex; gap: 20px; margin: 25px; }
        .player-card { padding: 20px; border: 3px solid white; border-radius: 15px; cursor: pointer; width: 100px; text-align: center; }
        .selected { border-color: #f1c40f; background: rgba(241, 196, 15, 0.2); }

        #game-stage { display: none; height: 100vh; position: relative; }
        .zone { width: 100%; height: 50vh; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #top-zone { background: var(--p1-color); }
        #bottom-zone { background: var(--p2-color); }

        #rope-container { position: absolute; top: 50%; width: 100%; height: 12px; background: #8d6e63; z-index: 5; transition: transform 0.3s ease; }
        #center-flag { position: absolute; top: -15px; left: 50%; width: 10px; height: 40px; background: #f1c40f; transform: translateX(-50%); }

        .q-box { background: white; color: #333; padding: 20px; border-radius: 15px; width: 85%; max-width: 400px; font-weight: bold; text-align: center; z-index: 10; }
        .options { width: 85%; max-width: 400px; display: grid; gap: 10px; margin-top: 15px; z-index: 10; }
        .btn { padding: 15px; border: none; border-radius: 10px; background: #f8f9fa; font-size: 16px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div id="lobby">
    <h1>АРКАН ТАРТЫШ ОНЛАЙН</h1>
    <p>Оюнчу тандаңыз:</p>
    <div class="selector">
        <div class="player-card selected" id="c1" onclick="pick(1)"><span>♂️</span><br>Оюнчу 1</div>
        <div class="player-card" id="c2" onclick="pick(2)"><span>♀️</span><br>Оюнчу 2</div>
    </div>
    <button onclick="ready()" style="padding: 15px 50px; border-radius: 30px; background: #27ae60; color: white; border: none; font-size: 18px; cursor: pointer;">ОЮНГА КИРҮҮ</button>
</div>

<div id="game-stage">
    <div id="rope-container"><div id="center-flag"></div></div>
    <div class="zone" id="top-zone">
        <div class="q-box" id="q-text">Суроо жүктөлүүдө...</div>
        <div class="options" id="opt-box"></div>
    </div>
    <div class="zone" id="bottom-zone">
        <div style="font-size: 40px;" id="my-emoji">♂️</div>
        <p id="player-label">Оюнчу: 1</p>
    </div>
</div>

<script>
    // FIREBASE КОНФИГУРАЦИЯСЫ (Сен берген скриншотторго ылайыкталды)
    const firebaseConfig = {
        apiKey: "AIzaSyC...", // Бул жерге өзүңдүн толук API Key'ди кой
        authDomain: "oilon-31eca.firebaseapp.com",
        databaseURL: "https://oilon-31eca-default-rtdb.firebaseio.com",
        projectId: "oilon-31eca",
        storageBucket: "oilon-31eca.appspot.com",
        messagingSenderId: "САНДАРДЫ_КОЙ",
        appId: "APP_ID_КОЙ"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database(// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCRHivUyg6XFUZvRZziLW7OHibPaViTYoM",
  authDomain: "oilon-31eca.firebaseapp.com",
  databaseURL: "https://oilon-31eca-default-rtdb.firebaseio.com",
  projectId: "oilon-31eca",
  storageBucket: "oilon-31eca.firebasestorage.app",
  messagingSenderId: "649734263962",
  appId: "1:649734263962:web:325ae8278e6fa0b847fb23",
  measurementId: "G-1N2ER1EBS0"
};);
    const gameRef = db.ref('online_duel');

    let myRole = 1;
    const questions = [
        { q: "Асманда эмне бар, жерде жок?", a: ["А тамгасы", "Булут", "Күн"], ok: 0 },
        { q: "Суудан чыгат, бирок суудан коркот?", a: ["Балык", "Туз", "Таш"], ok: 1 },
        { q: "Эң таттуу эмне?", a: ["Шекер", "Уйку", "Бал"], ok: 1 },
        { q: "Буту жок басат, оозу жок сүйлөйт?", a: ["Саат", "Кат", "Жел"], ok: 1 }
    ];

    function pick(n) {
        myRole = n;
        document.getElementById('c1').classList.toggle('selected', n===1);
        document.getElementById('c2').classList.toggle('selected', n===2);
    }

    function ready() {
        document.getElementById('lobby').style.display = 'none';
        document.getElementById('game-stage').style.display = 'block';
        document.getElementById('my-emoji').innerText = (myRole === 1 ? '♂️' : '♀️');
        document.getElementById('player-label').innerText = "Сиз: Оюнчу " + myRole;
        
        if(myRole === 1) gameRef.update({ ropePos: 0 }); 
        
        sync();
        ask();
    }

    function sync() {
        gameRef.on('value', (s) => {
            const d = s.val();
            if(d) {
                let p = d.ropePos || 0;
                document.getElementById('rope-container').style.transform = translateX(${p}px);
                if(p <= -200) finish("Оюнчу 1 (♂️) ЖЕҢДИ!");
                if(p >= 200) finish("Оюнчу 2 (♀️) ЖЕҢДИ!");
            }
        });
    }

    function ask() {
        let q = questions[Math.floor(Math.random() * questions.length)];
        document.getElementById('q-text').innerText = q.q;
        let box = document.getElementById('opt-box');
        box.innerHTML = '';
        
        q.a.forEach((txt, i) => {
            let b = document.createElement('button');
            b.className = 'btn';
            b.innerText = txt;
            b.onclick = () => {
                if(i === q.ok) {
                    gameRef.child('ropePos').transaction((currentPos) => {
                        return (currentPos || 0) + (myRole === 1 ? -40 : 40);
                    });
                    ask();
                } else {
                    b.style.background = "#ff7675";
                    setTimeout(() => b.style.background = "#f8f9fa", 300);
                }
            };
            box.appendChild(b);
        });
    }

    function finish(m) {
        alert(m);
        gameRef.set({ ropePos: 0 });
        location.reload();
    }
</script>
</body>
</html>